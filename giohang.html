<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gi·ªè H√†ng</title>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="style.css" />

    <link rel="stylesheet" href="https://unpkg.com/aos@2.3.4/dist/aos.css" />
    <link rel="stylesheet" href="assets/css/style.css" />
  </head>
  <body class="body-cart">
    <!-- header -->
    <div
      class="container-fluid top-bar d-flex justify-content-between bg-light border-bottom d-md-inline d-none"
    >
      <div class="row">
        <div class="col-4">
          <div class="icon-navbar ">
            <a href="#"><i class="bi bi-facebook"></i></a>
            <a href="#"><i class="bi bi-twitter"></i></a>
            <a href="#"><i class="bi bi-youtube"></i></a>
            <a href="#"><i class="bi bi-behance"></i></a>
          </div>
        </div>
        <div class="col-5"></div>
        <div class="col-3 d-flex me-auto">
          <div class="user-links text-dark pt-2 pb-2 d-flex ms-auto">
            <a
              href="dangnhap.html"
              type="button"
              class="nut mx-2 d-none d-md-block"
              ><i class="bi bi-person-fill"></i> T√†i kho·∫£n</a
            >
            <a
              href="giohang.html"
              type="button"
              class="nut mx-2 d-none d-md-block"
              ><i class="bi bi-bag-fill"></i> Gi·ªè h√†ng</a
            >
          </div>
        </div>
      </div>
    </div>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg bg-light sticky-top shadow-sm">
      <div class="container-lg">
        <!-- Logo -->
        <a class="navbar-brand fs-2 fw-bold" href="index.html">
          <span style="color: #f355a4">PK</span> Store
        </a>

        <!-- Button collapse -->
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <!-- Menu -->
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto align-items-lg-center">
            <!-- Menu ch√≠nh -->
            <li class="nav-item">
              <a class="nav-link" href="index.html">TRANG CH·ª¶</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="sanpham.html">S·∫¢N PH·∫®M</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="tacgia.html">T√ÅC GI·∫¢</a>
            </li>

            <!-- Hi·ªÉn th·ªã tr√™n mobile -->
            <li class="nav-item d-md-none">
              <a class="nav-link fw-bold" href="dangnhap.html">T√ÄI KHO·∫¢N</a>
            </li>
            <li class="nav-item d-md-none">
              <a class="nav-link fw-bold" href="giohang.html">GI·ªé H√ÄNG</a>
            </li>

            <!-- Dropdown -->
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                data-bs-toggle="dropdown"
              >
                TH√äM
              </a>
              <ul class="dropdown-menu bg-light">
                <li><a class="dropdown-item" href="lienhe.html">Li√™n h·ªá</a></li>
                <li>
                  <a class="dropdown-item" href="gioithieu.html">Gi·ªõi thi·ªáu</a>
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li>
                  <a
                    class="dropdown-item fw-semibold"
                    href="lichsu.html"
                    style="color: #f355a4"
                  >
                    L·ªãch s·ª≠ mua h√†ng
                  </a>
                </li>
              </ul>
            </li>
          </ul>

          <!-- Form t√¨m ki·∫øm -->
          <form class="d-flex ms-lg-3 mt-2 mt-lg-0" role="search">
            <input
              class="form-control"
              type="search"
              placeholder="T√¨m ki·∫øm s√°ch..."
              aria-label="Search"
              style="border-radius: 20px; border-color: #f355a4"
            />
            <button
              class="btn ms-2"
              type="submit"
              style="
                background-color: #f355a4;
                color: white;
                border-radius: 20px;
              "
            >
              üîç
            </button>
          </form>
          <div
      class="container-fluid top-bar d-flex justify-content-between bg-light border-bottom d-md-none d-block"
    >
      <div class="icon-navbar mt-md-2 my-3">
        <a href="#"><i class="bi bi-facebook"></i></a>
        <a href="#"><i class="bi bi-twitter"></i></a>
        <a href="#"><i class="bi bi-youtube"></i></a>
        <a href="#"><i class="bi bi-behance"></i></a>
      </div>
      <div class="user-links text-dark pt-2 pb-2 d-flex flex-wrap ms-auto">
        <a href="dangnhap.html" type="button" class="nut m-2 d-none d-md-block"
          ><i class="bi bi-person-fill"></i> T√†i kho·∫£n</a
        >
        <a href="giohang.html" type="button" class="nut m-2 d-none d-md-block"
          ><i class="bi bi-bag-fill"></i> Gi·ªè h√†ng</a
        >
      </div>
    </div>
        </div>
      </div>
    </nav>

    <main class="cart-container">
      <!-- Gi·ªè h√†ng -->
      <!-- GI·ªé H√ÄNG -->
<section class="cart-left">
  <h2>üõí Gi·ªè H√†ng <span id="cartCount">(0 s·∫£n ph·∫©m)</span></h2>

  <div class="check-all mb-3">
    <input type="checkbox" id="checkAll" class="form-check-input p-2" />
    <label for="checkAll">Ch·ªçn t·∫•t c·∫£</label>
  </div>

  <!-- Danh s√°ch s·∫£n ph·∫©m -->
  <div id="cartList"></div>
</section>


      <!-- T√≥m t·∫Øt -->
      <aside class="cart-right sticky-lg-top" style="top: 90px">
        <div class="promotion">
          <h3>üéÅ Khuy·∫øn M√£i</h3>
          <div class="promo-box">
            <p><strong>M√£ gi·∫£m 10K</strong> ‚Äì To√†n s·∫£n ph·∫©m</p>
            <p>√Åp d·ª•ng cho ƒë∆°n t·ª´ 130.000 ‚Ç´</p>
            <div class="progress">
              <div class="bar" style="width: 60%"></div>
            </div>
            <button class="add-more">Mua th√™m</button>
          </div>
        </div>

        <div class="summary">
          <div class="row">
            <span>T·ªïng c·ªông (g·ªìm VAT):</span>
            <span class="total">50.000 ‚Ç´</span>
          </div>
          <a href="thanhtoan.html" class="thanhtoan">THANH TO√ÅN</a>
          <p class="note">Gi·∫£m gi√° ch·ªâ √°p d·ª•ng cho ƒë∆°n b√°n l·∫ª</p>
        </div>
      </aside>
    </main>

    <!-- Portfolio Section -->
    <section class="portfolio">
      <div class="container py-5">
        <div class="row g-3 align-items-center">
          <div class="col-md-5">
            <img src="assets/images/tacgia1.jpg" class="img-fluid w-75" />
          </div>
          <div class="col-md-7">
            <p>
              Her laugh is free. Her pose is soft‚Äîelegant, stylish, unique. Each
              frame crafted and captured through artistic vision and modern
              simplicity. She‚Äôs herself, unfiltered, bold, confident.
            </p>
            <p>
              Discover timeless beauty through our lens. Whether it‚Äôs fashion or
              lifestyle, we‚Äôre here to help you find yourself through
              professional photography and authentic storytelling.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer Gallery -->
    <section class="footer-gallery text-center py-4 text-white">
      <div class="container">
        <h1 class="mb-4 text-dark">Truy·ªán ƒë·ªÅ xu·∫•t</h1>
        <div class="row g-4 justify-content-center">
          <div class="col-md-3">
            <img
              src="assets/images/·∫£nh truy·ªán/sach22.jpg"
              class="img-fluid container-sm w-75"
              alt=""
            />
          </div>
          <div class="col-md-3">
            <img
              src="assets/images/·∫£nh truy·ªán/sach20.jpg"
              class="img-fluid container-sm w-75"
              alt=""
            />
          </div>
          <div class="col-md-3">
            <img
              src="assets/images/·∫£nh truy·ªán/sach24.jpg"
              class="img-fluid container-sm w-75"
              alt=""
            />
          </div>
        </div>
      </div>
      <hr />
    </section>

    <!-- nh·∫≠n th√¥ng tin -->
    <section id="subscribe" class="py-5 mb-2">
      <div class="container">
        <div class="row justify-content-center align-items-center">
          <!-- C·ªôt tr√°i -->
          <div class="col-md-5 mb-4 mb-md-0">
            <h2 class="fw-bold mb-3">ƒêƒÉng K√Ω Nh·∫≠n Tin M·ªõi</h2>
            <hr class="border-2 opacity-100" style="width: 80px" />
          </div>

          <!-- C·ªôt ph·∫£i -->
          <div class="col-md-7">
            <p class="mb-4">
              Sed eu feugiat amet, libero ipsum enim pharetra hac dolor sit
              amet, consectetur. Elit adipiscing enim pharetra hac Lorem ipsum
              dolor sit amet consectetur adipisicing elit. Ut odio amet officiis
              aspernatur, corporis et architecto possimus laboriosam nemo illo
              voluptatem provident hic optio consectetur nobis? Ipsam soluta
              tenetur adipisci.
            </p>
            <form class="d-flex pb-2">
              <input
                type="email"
                class="form-control border-0 shadow-none me-4"
                placeholder="       Enter your email address here"
              />
              <button
                type="submit"
                class="btn fw-bold text-white text-uppercase d-flex align-items-center gap-2 ps-4"
                style="background-color: #f355a4"
              >
                X√°c Nh·∫≠n <i class="bi bi-send"></i>
              </button>
            </form>
          </div>
        </div>
      </div>
    </section>

    <footer class="footer pt-5">
      <div class="container-lg">
        <div class="row g-4">
          <!-- Company Info -->
          <div class="col-lg-4 col-md-12">
            <h3 class="footer-title">
              PK <span style="color: black">Store</span>
            </h3>
            <p class="mb-4">
              ƒê·ªçc s√°ch c√≥ vai tr√≤ v√¥ c√πng quan tr·ªçng trong vi·ªác m·ªü r·ªông tri th·ª©c
              v√† r√®n luy·ªán t∆∞ duy. Qua nh·ªØng trang s√°ch, ch√∫ng ta kh√¥ng ch·ªâ ti·∫øp
              thu ki·∫øn th·ª©c m·ªõi m√† c√≤n h·ªçc ƒë∆∞·ª£c c√°ch nh√¨n nh·∫≠n, ph√¢n t√≠ch v√†
              gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ
            </p>
            <div class="social-links mb-3">
              <a href="#"><i class="bi bi-facebook"></i></a>
              <a href="#"><i class="bi bi-instagram"></i></a>
              <a href="#"><i class="bi bi-youtube"></i></a>
              <a href="#"><i class="bi bi-tiktok"></i></a>
              <a href="#"><i class="bi bi-github"></i></a>
            </div>
          </div>

          <div class="col-lg-2 col-6">
            <h3 class="footer-title">Ch√∫ng t√¥i</h3>
            <ul class="footer-links">
              <li><a href="gioithieu.php">M·ª•c ti√™u</a></li>
              <li><a href="gioithieu.php">ƒê·ªãnh h∆∞·ªõng</a></li>
              <li><a href="#">ƒêi·ªÅu kho·∫£n d·ªãch v·ª•</a></li>
            </ul>
          </div>

          <div class="col-lg-2 col-6">
            <h3 class="footer-title">Kh√°m ph√°</h3>
            <ul class="footer-links">
              <li><a href="home.php">Trang ch·ªß</a></li>
              <li><a href="sanpham.php">S·∫£n ph·∫©m</a></li>
              <li><a href="tacgia.php">T√°c gi·∫£</a></li>
              <li><a href="lienhe.php">Li√™n h·ªá</a></li>
              <li><a href="gioithieu.php">Gi·ªõi thi·ªáu</a></li>
            </ul>
          </div>

          <div class="col-lg-2 col-6">
            <h3 class="footer-title">T√†i kho·∫£n</h3>
            <ul class="footer-links">
              <li><a href="../assets/login.php">ƒêƒÉng nh·∫≠p</a></li>
              <li><a href="../assets/cart.php">Gi·ªè h√†ng</a></li>
            </ul>
          </div>

          <div class="col-lg-2 col-6">
            <h3 class="footer-title">H·ªó tr·ª£</h3>
            <ul class="footer-links">
              <li><a href="lienhe.php">Trung t√¢m h·ªó tr·ª£</a></li>
              <li><a href="lienhe.php">B√°o c√°o s·ª± c·ªë</a></li>
              <li><a href="lienhe.php">ƒê·ªÅ xu·∫•t ch·ªânh s·ª≠a</a></li>
              <li><a href="lienhe.php">Li√™n h·ªá</a></li>
            </ul>
          </div>
        </div>
        <p class="m-0 mt-3 pb-1 text-secondary text-center">
          ¬© 2025 PK Store ‚Äì ƒê·ªçc s√°ch m·ªói ng√†y, m·ªü r·ªông tri th·ª©c.
        </p>
      </div>
    </footer>

    <script>
      // L·∫•y ph·∫ßn t·ª≠ checkbox ch√≠nh
      const checkAll = document.getElementById("checkAll");
      // L·∫•y t·∫•t c·∫£ checkbox c·ªßa s·∫£n ph·∫©m
      const itemCheckboxes = document.querySelectorAll(".form-check-input");

      // Khi b·∫•m "ch·ªçn t·∫•t c·∫£"
      checkAll.addEventListener("change", () => {
        itemCheckboxes.forEach((cb) => {
          cb.checked = checkAll.checked;
        });
      });

      // Khi b·ªè ch·ªçn t·ª´ng checkbox con ‚Üí c·∫≠p nh·∫≠t l·∫°i tr·∫°ng th√°i c·ªßa "ch·ªçn t·∫•t c·∫£"
      itemCheckboxes.forEach((cb) => {
        cb.addEventListener("change", () => {
          const allChecked = Array.from(itemCheckboxes).every(
            (item) => item.checked
          );
          checkAll.checked = allChecked;
        });
      });
    </script>
    <script>
  const API_BASE = "http://localhost:3000/api/books";

  // üõí L·∫•y danh s√°ch t·ª´ localStorage
  const cart = JSON.parse(localStorage.getItem("cart") || "[]");
  const cartList = document.getElementById("cartList");
  const cartCount = document.getElementById("cartCount");

  if (cart.length === 0) {
    cartList.innerHTML = `<div class='alert alert-warning text-center'>Gi·ªè h√†ng tr·ªëng!</div>`;
    cartCount.textContent = "(0 s·∫£n ph·∫©m)";
  } else {
    cartCount.textContent = `(${cart.length} s·∫£n ph·∫©m)`;
    renderCart();
  }

  async function renderCart() {
    cartList.innerHTML = `<p class="text-center text-muted">ƒêang t·∫£i s·∫£n ph·∫©m...</p>`;

    let total = 0;
    let html = "";

    for (const item of cart) {
      try {
        const res = await fetch(`${API_BASE}/${item.id}`);
        const product = await res.json();

        const price = product.price * (1 - (product.discount || 0) / 100);
        total += price * item.quantity;

        html += `
          <div class="cart-item d-flex align-items-center border-bottom py-3">
            <input type="checkbox" class="form-check-input me-auto p-2" />

            <img
              src="${normalizeImageUrl(product.image)}"
              alt="${product.title}"
              class="cart-img me-3"
              style="width: 100px; height: 120px; object-fit: cover;"
            />

            <div class="cart-info flex-grow-1">
              <p class="mb-1 fw-medium">${product.title}</p>

              <div class="mb-2">
                <span class="fw-bold text-danger me-2">${price.toLocaleString()} ƒë</span>
                ${
                  product.discount
                    ? `<span class="text-muted text-decoration-line-through small">
                        ${product.price.toLocaleString()} ƒë
                       </span>`
                    : ""
                }
              </div>

              <div class="d-flex align-items-center justify-content-between">
                <div class="d-flex align-items-center border rounded">
                  <button class="btn btn-sm btn-light" onclick="updateQty(${product.id}, -1)">‚àí</button>
                  <span class="px-2" id="qty-${product.id}">${item.quantity}</span>
                  <button class="btn btn-sm btn-light" onclick="updateQty(${product.id}, 1)">Ôºã</button>
                </div>

                <button class="btn btn-outline-danger btn-sm ms-2" onclick="removeFromCart(${product.id})">
                  <i class="bi bi-trash"></i>
                </button>
              </div>
            </div>
          </div>
        `;
      } catch (e) {
        console.error(e);
      }
    }

    cartList.innerHTML = html;
    document.querySelector(".total").textContent = total.toLocaleString() + " ‚Ç´";
  }

  function normalizeImageUrl(path) {
    if (!path) return "https://via.placeholder.com/120x150?text=No+Image";
    if (path.startsWith("http")) return path;
    return `http://localhost:3000${path.startsWith("/") ? path : "/" + path}`;
  }

  function updateQty(id, change) {
    const index = cart.findIndex((p) => p.id === id);
    if (index !== -1) {
      cart[index].quantity = Math.max(1, cart[index].quantity + change);
      localStorage.setItem("cart", JSON.stringify(cart));
      renderCart();
    }
  }

  function removeFromCart(id) {
    const newCart = cart.filter((p) => p.id !== id);
    localStorage.setItem("cart", JSON.stringify(newCart));
    location.reload();
  }
</script>

  </body>
</html>
